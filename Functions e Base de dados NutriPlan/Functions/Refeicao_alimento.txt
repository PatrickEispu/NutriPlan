CREATE OR REPLACE FUNCTION adicionar_alimento_na_refeicao(
    p_fk_nr_id_refeicao INT,
    p_fk_nr_id_alimento INT,
    p_nr_quantidade INT
)
RETURNS VOID AS $$
BEGIN
    INSERT INTO refeicao_alimento (fk_nr_id_refeicao, fk_nr_id_alimento, nr_quantidade)
    VALUES (p_fk_nr_id_refeicao, p_fk_nr_id_alimento, p_nr_quantidade);
END;
$$ LANGUAGE plpgsql;

CREATE OR REPLACE FUNCTION buscar_alimento_na_refeicao(
    p_fk_nr_id_refeicao INT,
    p_fk_nr_id_alimento INT
)
RETURNS TABLE(
    fk_nr_id_refeicao INT,
    fk_nr_id_alimento INT,
    nr_quantidade INT
) AS $$
BEGIN
    RETURN QUERY
    SELECT fk_nr_id_refeicao, fk_nr_id_alimento, nr_quantidade
    FROM refeicao_alimento
    WHERE fk_nr_id_refeicao = p_fk_nr_id_refeicao AND fk_nr_id_alimento = p_fk_nr_id_alimento;
END;
$$ LANGUAGE plpgsql;

CREATE OR REPLACE FUNCTION atualizar_quantidade_alimento_na_refeicao(
    p_fk_nr_id_refeicao INT,
    p_fk_nr_id_alimento INT,
    p_nr_quantidade INT
)
RETURNS VOID AS $$
BEGIN
    UPDATE refeicao_alimento
    SET nr_quantidade = p_nr_quantidade
    WHERE fk_nr_id_refeicao = p_fk_nr_id_refeicao AND fk_nr_id_alimento = p_fk_nr_id_alimento;
END;
$$ LANGUAGE plpgsql;

CREATE OR REPLACE FUNCTION remover_alimento_da_refeicao(
    p_fk_nr_id_refeicao INT,
    p_fk_nr_id_alimento INT
)
RETURNS VOID AS $$
BEGIN
    DELETE FROM refeicao_alimento
    WHERE fk_nr_id_refeicao = p_fk_nr_id_refeicao AND fk_nr_id_alimento = p_fk_nr_id_alimento;
END;
$$ LANGUAGE plpgsql;
